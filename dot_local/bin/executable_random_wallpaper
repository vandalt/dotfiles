#!/usr/bin/bash

if [[ $# -lt 1 ]] || [[ ! -d $1   ]]; then
  echo "Usage:
  $0 <dir containing images>"
  exit 1
fi

if ! type "fd" > /dev/null 2>&1; then
  echo "ERROR: 'fd' command doesn't exist!"
  exit 1
fi

get_random_img() {
  fd -t f . "$1" | shuf -n 1
}

pids=$(pgrep swaybg)
swaybg -i "$(get_random_img "$@")" -m fill &
sleep 0.3
for pid in $pids; do
    kill "$pid"
done
export RANDNOM_WALLPAPER_PID=$!
